importing the data set

```{r}
library(tidyverse)

movies_data <- read.csv("movies.csv")

```

cleaning up the data set

```{r}
ml_data <- movies_data %>%
  select(budget, revenue, runtime, vote_average, vote_count) %>%
  distinct() %>%
  na.omit() %>%
  filter(budget != 0 & revenue != 0 & runtime != 0 & vote_average != 0 & vote_count != 0)

```

Modeling

```{r}
library(tidymodels)
```

Splitting the data into training and testing sets

```{r}
# Data Splitting using rsample
set.seed(18)
datasplit <- initial_split(ml_data,
                           prop = 0.70, #default is 0.75
                           strata = revenue)
datasplit
```

```{r}
data_train <- training(datasplit)
data_train
```

```{r}
data_test <- testing(datasplit)
data_test
```

Setting a recipe for preprocessing and feature engineering

```{r}
# Recipe using recipe
ml_rec <- recipe(revenue ~ ., data = data_train) %>%
        step_normalize(all_numeric_predictors())
ml_rec
```

Setting the Model Specifications

```{r}

# Model: Linear Regression using parsnip
ml_model <- rand_forest() %>%
  set_engine('ranger') %>%
  set_mode('regression')

# RSE can be found in the summary of a model.
summary(ml_model)
```

Creating a worflow to bind preprocessor and model

```{r}
library(rules)
# Workflow using workflow
ml_wf <- workflow() %>%
        add_recipe(ml_rec) %>%
        add_model(ml_model)
ml_wf
```

Training the model on the train set

```{r}
# Training
ml_trained <- ml_wf %>%
        fit(data_train)
ml_trained
```

Evaluating Model on the test set The Root Mean Squared Error (RMSE) is one of the two main performance indicators for a regression model. It measures the average difference between values predicted by a model and the actual values. It provides an estimation of how well the model is able to predict the target value (accuracy).

```{r}
# Predict the test set
result_final <- ml_trained %>%
        predict(data_test)
result_final
```

```{r}
pred <- bind_cols(data_test, result_final) %>%
        select(revenue, .pred)
pred
```

```{r}
# Calculate RMSE
result_metrics <- pred %>%
        rmse(truth = revenue, estimate = .pred)
result_metrics
```

```{r}
pred %>%
        ggplot() +
        geom_line(aes(revenue, .pred), col = "blue3")
```

```{r}
saveRDS(ml_trained,file = "model.rds")
```
